# 🎨 语音转文字插件 - TDesign UI 重构方案

## 📋 项目概述

基于您的要求，我已经完成了语音转文字桌面插件的前端UI重构，采用 **TDesign + React** 技术栈，参考 **QQ音乐** 的界面设计风格。

## 🎯 设计特色

### ✨ QQ音乐风格设计
- **简洁圆角**：所有组件采用圆角设计，视觉柔和
- **合理留白**：参考QQ音乐的布局，保持舒适的视觉间距
- **毛玻璃效果**：使用backdrop-filter实现现代化毛玻璃背景
- **绿色主题**：采用QQ音乐的绿色（#00c756）作为主题色

### 🎛️ 界面布局
- **顶部导航栏**：Logo、状态显示、引擎切换、设置
- **中央内容区**：大面积文本编辑器，支持实时显示
- **底部操作栏**：圆形录音按钮、清空、复制等功能

## 📁 文件结构

```
frontend/
├── package.json              # 项目依赖
├── public/
│   └── index.html            # HTML模板
└── src/
    ├── index.js              # React入口
    ├── index.css             # 全局样式
    ├── App.jsx               # 主应用组件
    ├── App.css               # App样式
    └── components/
        ├── SpeechApp.jsx     # 核心语音识别组件
        └── SpeechApp.css     # 组件样式

webview_integration.py        # PyQt5集成方案
前端重构说明.md              # 使用说明
```

## 🚀 快速开始

### 1. 安装前端依赖

```bash
cd frontend
npm install
```

### 2. 开发模式运行

```bash
npm start
```
浏览器访问：http://localhost:3000

### 3. 构建生产版本

```bash
npm run build
```

## 🔗 与 PyQt5 集成

### 方法一：WebView集成（推荐）

```python
# 使用提供的webview_integration.py
python webview_integration.py
```

### 方法二：修改现有GUI

将现有的 `gui_with_engine_selector.py` 替换为WebView：

```python
from PyQt5.QtWebEngineWidgets import QWebEngineView
from PyQt5.QtCore import QUrl

class ModernGUI(QMainWindow):
    def __init__(self):
        super().__init__()
        self.web_view = QWebEngineView()
        self.setCentralWidget(self.web_view)
        
        # 加载React应用
        self.web_view.load(QUrl('http://localhost:3000'))
```

## 🔌 API接口说明

### Python → JavaScript

```javascript
// 接收语音识别结果
window.speechToTextAPI.onTextRecognized("识别的文字");

// 更新状态
window.speechToTextAPI.onStatusChanged("正在录音...");

// 显示错误
window.speechToTextAPI.onErrorOccurred("错误信息");
```

### JavaScript → Python

```javascript
// 开始录音
window.pywebview.api.start_listening('baidu');

// 停止录音
window.pywebview.api.stop_listening();

// 切换引擎
window.pywebview.api.change_engine('google');

// 切换置顶
window.pywebview.api.toggle_always_on_top(true);
```

## 🎨 界面特性

### 🎤 录音按钮
- **静态状态**：绿色渐变圆形按钮
- **录音状态**：红色渐变 + 脉冲动画
- **悬停效果**：轻微上浮 + 阴影增强

### 📝 文本编辑器
- **自适应高度**：根据内容自动调整
- **实时统计**：显示字符数和词数
- **现代滚动条**：自定义样式
- **占位提示**：友好的使用说明

### 🏷️ 状态标签
- **成功状态**：绿色标签（准备就绪）
- **进行状态**：橙色标签（正在录音）
- **错误状态**：红色标签（识别失败）

### 🎛️ 引擎切换
- **下拉菜单**：百度、Google、本地三选项
- **当前标识**：高亮显示当前选中引擎
- **无缝切换**：保持用户操作连续性

## 💡 核心组件解析

### SpeechApp.jsx 主要功能

```jsx
// 🔗 关键接口挂钩点
const startRecording = () => {
  // 与Python后端通信
  if (window.pywebview) {
    window.pywebview.api.start_listening(engine);
  }
};

// 监听Python消息
useEffect(() => {
  const handlePythonMessage = (event) => {
    const { type, data } = event.detail;
    // 处理不同类型的消息
  };
  
  window.addEventListener('pythonMessage', handlePythonMessage);
}, []);
```

### 状态管理

```jsx
// React状态管理
const [isRecording, setIsRecording] = useState(false);
const [text, setText] = useState('');
const [status, setStatus] = useState('准备就绪');
const [engine, setEngine] = useState('baidu');
const [isPinned, setIsPinned] = useState(false);
```

## 🎭 主题定制

### 颜色方案

```css
:root {
  --primary-color: #00c756;      /* QQ音乐绿 */
  --primary-dark: #00a84f;       /* 深绿色 */
  --background: #f5f7fa;         /* 浅灰背景 */
  --surface: rgba(255,255,255,0.9); /* 毛玻璃表面 */
  --text: #1f2937;              /* 深色文字 */
  --text-secondary: #6b7280;     /* 次要文字 */
}
```

### 响应式设计

- **桌面端**：完整功能布局
- **移动端**：简化布局，堆叠式排列
- **WebView**：自适应容器大小

## 🔧 开发环境配置

### VS Code 推荐扩展

```json
{
  "recommendations": [
    "bradlc.vscode-tailwindcss",
    "esbenp.prettier-vscode",
    "ms-vscode.vscode-typescript-next"
  ]
}
```

### 代码格式化配置

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5"
}
```

## 🚀 部署方案

### 1. 开发环境
- React开发服务器：`npm start`
- PyQt5加载：`http://localhost:3000`

### 2. 生产环境
- 构建React应用：`npm run build`
- PyQt5加载：本地build文件

### 3. 打包分发
- 使用PyInstaller打包整个应用
- 包含构建后的前端文件

## 🎯 核心优势

### ✅ 用户体验
- **现代化界面**：符合当前设计趋势
- **流畅动画**：提升操作反馈
- **直观操作**：降低学习成本

### ✅ 技术优势
- **组件化开发**：易于维护和扩展
- **TDesign体系**：完整的设计语言
- **无缝集成**：保持原有功能逻辑

### ✅ 维护性
- **模块化代码**：结构清晰
- **接口分离**：前后端解耦
- **扩展友好**：易于添加新功能

## 🔮 未来扩展

### 计划功能
- [ ] 深色模式切换
- [ ] 自定义主题配置
- [ ] 快捷键支持
- [ ] 语音可视化
- [ ] 历史记录管理

### 技术升级
- [ ] TypeScript支持
- [ ] 单元测试覆盖
- [ ] 性能监控
- [ ] 错误追踪

---

## 📞 技术支持

如果在使用过程中遇到问题，请检查：

1. **依赖安装**：确保所有npm包已安装
2. **端口占用**：确保3000端口未被占用
3. **Python环境**：确保PyQt5和WebEngine已安装
4. **网络连接**：如果使用开发服务器模式

**这套方案完全保持了原有的功能逻辑，只是将界面现代化，提供了更好的用户体验！** 🎉 